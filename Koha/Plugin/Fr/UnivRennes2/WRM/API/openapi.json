{
    "/update_status": {
        "post": {
            "x-mojo-to": "Fr::UnivRennes2::WRM::API::WarehouseRequestConnector#update_status",
            "operationId": "updateWRstatus",
            "tags": ["warehouserequests"],
            "produces": [
                "application/json"
            ],
            "parameters": [
                {
                    "name": "id",
                    "in": "formData",
                    "description": "Internal warehouse request identifier",
                    "required": true,
                    "type": "integer"
                },{
                    "name": "action",
                    "in": "formData",
                    "description": "Action to process to the warehouse request",
                    "required": true,
                    "type": "string",
                    "enum": [
                        "process",
                        "wait",
                        "complete",
                        "cancel"
                    ],
                    "default": "process"
                },{
                    "name": "notes",
                    "in": "formData",
                    "description": "Reasons to cancelation",
                    "required": false,
                    "type": "string"
                }
            ],
            "responses": {
                "200": {
                    "description": "Successness of the status update",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "success": {
                                "description": "Tells if the action succeeded",
                                "type": "boolean"
                            }
                        }
                    }
                },
                "403": {
                    "description": "An error occured",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "error": {
                                "description": "An explanation for the error",
                                "type": "string"
                            }
                        }
                    }
                },
                "404": {
                    "description": "An error occured",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "error": {
                                "description": "An explanation for the error",
                                "type": "string"
                            }
                        }
                    }
                },
                "502": {
                    "description": "An error occured",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "error": {
                                "description": "An explanation for the error",
                                "type": "string"
                            }
                        }
                    }
                }
            },
            "x-koha-authorization": {
                "permissions": {
                    "circulate": "1"
                }
            }
        }
    },
    "/request": {
        "get": {
            "x-mojo-to": "Fr::UnivRennes2::WRM::API::WarehouseRequestConnector#request",
            "operationId": "createWR",
            "tags": ["warehouserequests"],
            "produces": [
                "application/json"
            ],
            "parameters": [
                {
                    "name": "biblionumber",
                    "in": "query",
                    "description": "Requesteditem biblionumber",
                    "required": false,
                    "type": "integer"
                },{
                    "name": "itemnumber",
                    "in": "query",
                    "description": "Requested item itemnumber",
                    "required": false,
                    "type": "string"
                },{
                    "name": "callnumber",
                    "in": "query",
                    "description": "Requested item callnumber",
                    "required": false,
                    "type": "string"
                },{
                    "name": "type",
                    "in": "query",
                    "description": "Requested item type",
                    "required": false,
                    "type": "string"
                },{
                    "name": "volume",
                    "in": "query",
                    "description": "Requested item volume",
                    "required": false,
                    "type": "string"
                },{
                    "name": "issue",
                    "in": "query",
                    "description": "Requested item issue",
                    "required": false,
                    "type": "string"
                },{
                    "name": "year",
                    "in": "query",
                    "description": "Requested item year",
                    "required": false,
                    "type": "string"
                },{
                    "name": "message",
                    "in": "query",
                    "description": "Request comment",
                    "required": false,
                    "type": "string"
                },{
                    "name": "ticket",
                    "in": "query",
                    "description": "CAS ticket",
                    "required": false,
                    "type": "string"
                },{
                    "name": "callback",
                    "in": "query",
                    "description": "JSONP Callback",
                    "required": false,
                    "type": "string"
                }
            ],
            "responses": {
                "200": {
                    "description": "Successness of the creation",
                    "schema": {
                        "type": "string",
                        "description": "JSONP response"
                    }
                },
                "404": {
                    "description": "An error occured",
                    "schema": {
                        "type": "string",
                        "description": "JSONP formatted error"
                    }
                },
                "502": {
                    "description": "An error occured",
                    "schema": {
                        "type": "string",
                        "description": "JSONP formatted error"
                    }
                }
            }
        }
    },
    "/list": {
        "get": {
            "x-mojo-to": "Fr::UnivRennes2::WRM::API::WarehouseRequestConnector#list",
            "operationId": "listSelfWR",
            "tags": ["warehouserequests"],
            "produces": [
                "application/json; charset=utf-8"
            ],
            "parameters": [],
            "responses": {
                "200": {
                    "description": "List of the requests",
                    "schema": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "id": {
                                    "type": "integer",
                                    "description": "Internal WR identifier"
                                },
                                "itemnumber": {
                                    "type": "integer",
                                    "description": "Internal item identifier"
                                },
                                "item": {
                                    "type": "object",
                                    "description": "Item informations of the document",
                                    "properties": {
                                        "location": {
                                            "type": ["string","null"],
                                            "description": "Location of the requested item"
                                        },
                                        "itemcallnumber": {
                                            "type": ["string","null"],
                                            "description": "Callnumber of the requested item"
                                        }
                                    }
                                },
                                "biblio": {
                                    "type": "object",
                                    "description": "Biblio informations of the document",
                                    "properties": {
                                        "title": {
                                            "type": ["string","null"],
                                            "description": "Title of the requested item"
                                        },
                                        "author": {
                                            "type": ["string","null"],
                                            "description": "Author of the requested item"
                                        }
                                    }
                                },
                                "branchcode": {
                                    "type": "string",
                                    "description": "Internal library identifier"
                                },
                                "branchname": {
                                    "type": "string",
                                    "description": "Label ot the library"
                                },
                                "volume": {
                                    "type": ["string", "null"],
                                    "description": "Requested item volume"
                                },
                                "issue": {
                                    "type": ["string", "null"],
                                    "description": "Requested item issue"
                                },
                                "date": {
                                    "type": ["string", "null"],
                                    "description": "Requested item date"
                                },
                                "patron_name": {
                                    "type": ["string", "null"],
                                    "description": "Requested item date"
                                },
                                "patron_notes": {
                                    "type": ["string", "null"],
                                    "description": "Comment form the patron"
                                },
                                "status": {
                                    "type": "string",
                                    "enum": [
                                        "PENDING",
                                        "PROCESSING",
                                        "WAITING",
                                        "COMPLETED",
                                        "CANCELED"
                                    ],
                                    "description": "Status of the request"
                                },
                                "statusstr": {
                                    "type": "string",
                                    "description": "Labeled version of the request's status"
                                },
                                "created_on": {
                                    "type": "string",
                                    "format": "date-time",
                                    "description": "Timestamp for the request creation"
                                },
                                "update_on": {
                                    "type": "string",
                                    "format": "date-time",
                                    "description": "Timestamp for the latest hold update"
                                },
                                "deadline": {
                                    "type": ["string", "null"],
                                    "format": "date-time",
                                    "description": "Timestamp for the deadline to get the document"
                                }
                            }
                        }
                    }
                },
                "404": {
                    "description": "An error occured",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "error": {
                                "description": "An explanation for the error",
                                "type": "string"
                            }
                        }
                    }
                },
                "502": {
                    "description": "An error occured",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "error": {
                                "description": "An explanation for the error",
                                "type": "string"
                            }
                        }
                    }
                }
            },
            "x-koha-authorization": {
                "allow-owner": true
            }
        }
    },
    "/list/{borrowernumber}": {
        "get": {
            "x-mojo-to": "Fr::UnivRennes2::WRM::API::WarehouseRequestConnector#list",
            "operationId": "listUserWR",
            "tags": ["warehouserequests"],
            "produces": [
                "application/json; charset=utf-8"
            ],
            "parameters": [
                {
                    "name": "borrowernumber",
                    "in": "path",
                    "description": "Internal borrower identifier",
                    "required": true,
                    "type": "integer"
                }
            ],
            "responses": {
                "200": {
                    "description": "List of the requests",
                    "schema": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "id": {
                                    "type": "integer",
                                    "description": "Internal WR identifier"
                                },
                                "itemnumber": {
                                    "type": "integer",
                                    "description": "Internal item identifier"
                                },
                                "item": {
                                    "type": "object",
                                    "description": "Item informations of the document",
                                    "properties": {
                                        "location": {
                                            "type": "string",
                                            "description": "Location of the requested item"
                                        },
                                        "itemcallnumber": {
                                            "type": "string",
                                            "description": "Callnumber of the requested item"
                                        }
                                    }
                                },
                                "biblio": {
                                    "type": "object",
                                    "description": "Biblio informations of the document",
                                    "properties": {
                                        "title": {
                                            "type": "string",
                                            "description": "Title of the requested item"
                                        },
                                        "author": {
                                            "type": ["string","null"],
                                            "description": "Author of the requested item"
                                        }
                                    }
                                },
                                "branchcode": {
                                    "type": "string",
                                    "description": "Internal library identifier"
                                },
                                "branchname": {
                                    "type": "string",
                                    "description": "Label ot the library"
                                },
                                "volume": {
                                    "type": ["string", "null"],
                                    "description": "Requested item volume"
                                },
                                "issue": {
                                    "type": ["string", "null"],
                                    "description": "Requested item issue"
                                },
                                "date": {
                                    "type": ["string", "null"],
                                    "description": "Requested item date"
                                },
                                "patron_name": {
                                    "type": ["string", "null"],
                                    "description": "Requested item date"
                                },
                                "patron_notes": {
                                    "type": ["string", "null"],
                                    "description": "Comment form the patron"
                                },
                                "status": {
                                    "type": "string",
                                    "enum": [
                                        "PENDING",
                                        "PROCESSING",
                                        "WAITING",
                                        "COMPLETED",
                                        "CANCELED"
                                    ],
                                    "description": "Status of the request"
                                },
                                "statusstr": {
                                    "type": "string",
                                    "description": "Labeled version of the request's status"
                                },
                                "created_on": {
                                    "type": "string",
                                    "format": "date-time",
                                    "description": "Timestamp for the request creation"
                                },
                                "update_on": {
                                    "type": "string",
                                    "format": "date-time",
                                    "description": "Timestamp for the latest hold update"
                                },
                                "deadline": {
                                    "type": ["string", "null"],
                                    "format": "date-time",
                                    "description": "Timestamp for the deadline to get the document"
                                }
                            }
                        }
                    }
                },
                "404": {
                    "description": "An error occured",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "error": {
                                "description": "An explanation for the error",
                                "type": "string"
                            }
                        }
                    }
                },
                "502": {
                    "description": "An error occured",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "error": {
                                "description": "An explanation for the error",
                                "type": "string"
                            }
                        }
                    }
                }
            },
            "x-koha-authorization": {
                "permissions": {
                    "circulate": "circulate_remaining_permissions"
                }
            }
        }
    },
    "/list/are/{status}": {
        "get": {
            "x-mojo-to": "Fr::UnivRennes2::WRM::API::WarehouseRequestConnector#list",
            "operationId": "listWRbyStatus",
            "tags": ["warehouserequests"],
            "produces": [
                "application/json; charset=utf-8"
            ],
            "parameters": [
                {
                    "name": "status",
                    "in": "path",
                    "description": "WR Status",
                    "required": true,
                    "type": "string",
                    "enum": [
                        "PENDING",
                        "PROCESSING",
                        "WAITING",
                        "COMPLETED",
                        "CANCELED"
                    ]
                }
            ],
            "responses": {
                "200": {
                    "description": "List of the requests",
                    "schema": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "id": {
                                    "type": "integer",
                                    "description": "Internal WR identifier"
                                },
                                "itemnumber": {
                                    "type": "integer",
                                    "description": "Internal item identifier"
                                },
                                "item": {
                                    "type": "object",
                                    "description": "Item informations of the document",
                                    "properties": {
                                        "location": {
                                            "type": "string",
                                            "description": "Location of the requested item"
                                        },
                                        "itemcallnumber": {
                                            "type": "string",
                                            "description": "Callnumber of the requested item"
                                        },
                                        "barcode": {
                                            "type": ["string","null"],
                                            "description": "Barcode of the requested item"
                                        }
                                    }
                                },
                                "borrowernumber": {
                                    "type": "integer",
                                    "description": "Internal patron identifier"
                                },
                                "borrower": {
                                    "type": "object",
                                    "description": "Requester informations",
                                    "properties": {
                                        "surname": {
                                            "type": "string",
                                            "description": "Surname of the requester"
                                        },
                                        "firstname": {
                                            "type": ["string","null"],
                                            "description": "Firstname of the requester"
                                        },
                                        "phone": {
                                            "type": ["string","null"],
                                            "description": "Phone number of the requester"
                                        }
                                    }
                                },
                                "biblio": {
                                    "type": "object",
                                    "description": "Biblio informations of the document",
                                    "properties": {
                                        "title": {
                                            "type": "string",
                                            "description": "Title of the requested item"
                                        },
                                        "author": {
                                            "type": ["string","null"],
                                            "description": "Author of the requested item"
                                        }
                                    }
                                },
                                "branchcode": {
                                    "type": "string",
                                    "description": "Internal library identifier"
                                },
                                "branchname": {
                                    "type": "string",
                                    "description": "Label ot the library"
                                },
                                "volume": {
                                    "type": ["string", "null"],
                                    "description": "Requested item volume"
                                },
                                "issue": {
                                    "type": ["string", "null"],
                                    "description": "Requested item issue"
                                },
                                "date": {
                                    "type": ["string", "null"],
                                    "description": "Requested item date"
                                },
                                "patron_name": {
                                    "type": ["string", "null"],
                                    "description": "Requested item date"
                                },
                                "patron_notes": {
                                    "type": ["string", "null"],
                                    "description": "Comment form the patron"
                                },
                                "status": {
                                    "type": "string",
                                    "enum": [
                                        "PENDING",
                                        "PROCESSING",
                                        "WAITING",
                                        "COMPLETED",
                                        "CANCELED"
                                    ],
                                    "description": "Status of the request"
                                },
                                "statusstr": {
                                    "type": "string",
                                    "description": "Labeled version of the request's status"
                                },
                                "created_on": {
                                    "type": "string",
                                    "format": "date-time",
                                    "description": "Timestamp for the request creation"
                                },
                                "update_on": {
                                    "type": "string",
                                    "format": "date-time",
                                    "description": "Timestamp for the latest hold update"
                                },
                                "deadline": {
                                    "type": ["string", "null"],
                                    "format": "date-time",
                                    "description": "Timestamp for the deadline to get the document"
                                }
                            }
                        }
                    }
                },
                "404": {
                    "description": "An error occured",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "error": {
                                "description": "An explanation for the error",
                                "type": "string"
                            }
                        }
                    }
                },
                "502": {
                    "description": "An error occured",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "error": {
                                "description": "An explanation for the error",
                                "type": "string"
                            }
                        }
                    }
                }
            },
            "x-koha-authorization": {
                "permissions": {
                    "circulate": "circulate_remaining_permissions"
                }
            }
        }
    },
    "/biblio/{biblionumber}": {
        "get": {
            "x-mojo-to": "Fr::UnivRennes2::WRM::API::WarehouseRequestConnector#check_requestable_items",
            "operationId": "check_requestable_items",
            "tags": ["warehouserequests"],
            "parameters": [{
                "description": "Internal identifier for biblio record",
                "in": "path",
                "name": "biblionumber",
                "required": true,
                "type": "integer"
            }],
            "produces": [
                "application/json"
            ],
            "responses": {
                "200": {
                    "description": "return items requestable from warehouse"
                },
                "404": {
                    "description": "An error occured",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "error": {
                                "description": "An explanation for the error",
                                "type": "string"
                            }
                        }
                    }
                },
                "502": {
                    "description": "An error occured",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "error": {
                                "description": "An explanation for the error",
                                "type": "string"
                            }
                        }
                    }
                }
            }
        }
    },
    "/count": {
        "get": {
            "x-mojo-to": "Fr::UnivRennes2::WRM::API::WarehouseRequestConnector#count",
            "operationId": "countWR",
            "tags": ["warehouserequests"],
            "produces": [
                "application/json; charset=utf-8"
            ],
            "parameters": [
                {
                    "name": "biblionumber",
                    "in": "query",
                    "description": "Internal bilbionumber identifier",
                    "required": false,
                    "type": "integer"
                }
            ],
            "responses": {
                "200": {
                    "description": "List of the requests",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "count": {
                                "description": "Number of requests",
                                "type": "integer"
                            }
                        }
                    }
                },
                "404": {
                    "description": "An error occured",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "error": {
                                "description": "An explanation for the error",
                                "type": "string"
                            }
                        }
                    }
                },
                "502": {
                    "description": "An error occured",
                    "schema": {
                        "type": "object",
                        "properties": {
                            "error": {
                                "description": "An explanation for the error",
                                "type": "string"
                            }
                        }
                    }
                }
            },
            "x-koha-authorization": {
                "permissions": {
                    "circulate": "circulate_remaining_permissions"
                }
            }
        }
    }
}